{% extends 'gl4app/base.html' %}
{% load crispy_forms_tags %}
{% load i18n %}

{% block title %}
{% blocktrans %}Photos of {{view_user.profile.name}}{% endblocktrans %}
{% endblock %}

{% block title2 %}
{% blocktrans %}Photos of {{view_user.profile.name}}{% endblocktrans %}
{% endblock %}

{% block description %}
{% blocktrans %}The company overview for {{view_user.profile.name}}.{% endblocktrans %}
{% endblock %}

{% block head %}
<style>
  section.photo-upload-form { display: block; padding: 10px; background: #DDD; }
  section.photo-upload-form.loading { background: #DDD url('/static/img/loading1.gif') center center no-repeat; }
  section.photo-upload-form.loading form { opacity: 0; }

  .fotoslist .item { position: relative; overflow: hidden; }
  .fotoslist .item .del { background: rgba(0,0,0,0.28); color: black; font-size: 56px; text-shadow: 0 0 2px rgba(255,255,255,0.82); line-height: 56px; width: 56px; height: 56px; padding: 0; text-align: center; position: absolute; top: 4px; left: 4px; opacity: 0; }
  .fotoslist .item:hover .del { opacity: 1; cursor: pointer; }

</style>
{% endblock %}

{% block body_classes %}profile profile-home{% endblock %}

{% block breadcrumb %}
<a href="{% url 'companydb_home' %}">{% trans 'Natural Stone Company Directory' %}</a> &raquo;
<a href="{% url 'companydb_item' view_user.username %}">{{view_user.profile.name}}</a> &raquo;
{% endblock %}

{% block main %}

<h1 id="about-company-title">{% blocktrans %}Photos of {{view_user.profile.name}}{% endblocktrans %}</h1>

{% with 'photos' as view %}{% include 'companydb/tabnavi2.html' %}{% endwith %}

{% if user.is_authenticated and user == view_user %}
<section class="photo-upload-form">
  {% crispy form %}
</section>
{% endif %}

<div class="fotoslist" id="fotoslist">
  <p class="count">There are currently {{photos.paginator.count}} photos of the company {{view_user.profile.name}} here.</p>
  <div class="list">
    {% for item in photos %}
      <div class="item">
        <a href="{% url 'companydb_pic_item' item.id %}">
          <img src="/media/en/fotos_small/{{item.id}}.jpg" alt="">
          {% if user.is_authenticated and user == view_user %}
            <div class="del">X</div>
          {% endif %}
        </a>
      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}

{% block foot %}
<script>
  $('section.photo-upload-form form').on('submit', function() {
    $('section.photo-upload-form [type="submit"]').attr('disabled', 'disabled');
    $('section.photo-upload-form').addClass('loading');
  });

  $('.fotoslist .item .del').on('click', function(ev) {
    ev.preventDefault();
    ev.stopPropagation();

    if (confirm('Delete this picture?')) {
      $.ajax({

      });
    }
  });
</script>
{% endblock %}
